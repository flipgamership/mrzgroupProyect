<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MrzGroup rastreo</title>
    <link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>
    <!-- // css del software parte principal se importa bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous"> 
</head>
<body>

<!-- partial:index.partial.html -->
<nav class="bg-dark navbar-dark">
  <div class="container">
    <a href="" class="navbar-brand"><i class="fas fa-tree mr-2"></i>MrzGroup</a>
    
  </div>
  </nav>
<section id="header" class="jumbotron text-center">
    <br>
     <h1 class="display-3"><%= datos.awb %></h1>
     <p class="lead">Su servicio se encuentra con el siguiente historial de procesos</p>
    
     <% if (datos.proceso == 'En Proceso'){ %> 
      <h2 class="display-3 text-danger font-weight-bold">Está en proceso</h1>
      
      <% }else{ %>
        <h2 class="display-3 text-success font-weight-bold">Completo</h1>
       
       <% } %>
    
</section>
<hr class="d-grid gap-2 col-8 col-md-8 mx-auto" >
  <section class="d-grid gap-2 col-6 col-md-6 mx-auto">
    <p class="lead">Su servicio se encuentra actualmente en:  <strong><%= datos.status %></strong></p>

   
    <br>
    
    <% if (dataHistorial.length != 0){ %> 




    <% dataHistorial.forEach((historial) => {%>
    <div class="accordion" id="accordionExample<%=historial.id%>">
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingOne<%=historial.id%>">
          <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
            <%= historial.estatusHistorial %> -- <%= historial.fecha %>
          </button>
        </h2>
        <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne<%=historial.id%>" data-bs-parent="#accordionExample<%=historial.id%>">
          <div class="accordion-body">
            <div class="galery">
              <% dataImg.forEach((img) => {%>
              <% if (historial.awbID == img.idHistorial && historial.estatusHistorial== img.statusHistorial){ %> 
              <img src="./multer/archivosUser/<%= img.imagen %>" class="rounded float-left" alt="..." style="width:300px">
              <% } %>
              <% }) %>
            </div>  
            
            <p class="lead"><strong>Observaciones:</strong> <%= historial.observaciones %> </p>
            <p class="lead"><strong>fecha de actualización:</strong> <%= historial.fecha %></p>

          </div>
        </div>
      </div>
    </div>
    <% }) %>    
    <% }else{ %> 
      <div class="accordion" id="accordionExample<%=datos.id%>">
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingOne<%=datos.id%>">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              <%= datos.status %> -- <%= datos.fecha %>
            </button>
          </h2>
          <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne<%=datos.id%>" data-bs-parent="#accordionExample<%=datos.id%>">
            <div class="accordion-body">
              <p class="lead"><strong>Observaciones:</strong> su servicio apenas ingreso a nuestro sistema por favor esperar para mas actualizaciones</p>
              <p class="lead"><strong>fecha de actualización:</strong> <%= datos.fecha %></p>
  
            </div>
          </div>
        </div>
      </div>
      <% } %> 
  </section>
<div class="d-grid gap-2 col-3 col-md-3 mx-auto">
  <br>
  <a href="/loginAut" class="btn btn-danger">Cerrar Sesion <i class='bx bx-log-out' ></i></a>
</div>

    <!-- // script de bootstrap para su correcto funcionamiento -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/boxicons@2.1.2/dist/boxicons.js"></script>
</body>

</html>